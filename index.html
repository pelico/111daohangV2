<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Valar Morghulis - 个人导航中心</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <!-- Chart.js 仍然作为全局依赖引入 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
</head>
<body>
    
    <!-- 模板定义区 (新增) -->
    
    <!-- 1. 导航分类模板 -->
    <template id="tpl-nav-category">
        <div class="nav-category">
            <div class="category-title"><i></i><h2></h2></div>
            <div class="nav-links"></div>
        </div>
    </template>

    <!-- 2. NAS 卡片模板 -->
    <template id="tpl-nas-card">
        <div class="nas-card-container"> 
            <div class="host-name" style="font-weight: bold; color: var(--primary-dark); margin-bottom: 15px; text-align: center;"></div> 
            <div class="nas-card-grid"> 
                <div class="nas-metric-card">
                    <div class="nas-metric-icon"><i class="fas fa-microchip"></i></div>
                    <div class="nas-metric-details"><span class="nas-metric-label">CPU</span><div class="nas-metric-value val-cpu">--%</div></div>
                </div> 
                <div class="nas-metric-card">
                    <div class="nas-metric-icon"><i class="fas fa-memory"></i></div>
                    <div class="nas-metric-details">
                        <span class="nas-metric-label">内存</span>
                        <div class="nas-metric-value val-mem">--%</div>
                        <div class="nas-metric-subvalue sub-mem">--/--GB</div>
                    </div>
                </div> 
                <div class="nas-metric-card row-temp" style="display: none;">
                    <div class="nas-metric-icon"><i class="fas fa-thermometer-half"></i></div>
                    <div class="nas-metric-details"><span class="nas-metric-label">温度</span><div class="nas-metric-value val-temp">--°C</div></div>
                </div> 
                <div class="nas-metric-card">
                    <div class="nas-metric-icon"><i class="fas fa-exchange-alt"></i></div>
                    <div class="nas-metric-details"><span class="nas-metric-label">上传/下载</span><div class="nas-metric-value small-font val-net">-- / --</div></div>
                </div> 
                <div class="nas-metric-card">
                    <div class="nas-metric-icon"><i class="fas fa-hdd"></i></div>
                    <div class="nas-metric-details">
                        <span class="nas-metric-label">系统存储</span>
                        <div class="nas-metric-value val-disk">--%</div>
                        <div class="nas-metric-subvalue sub-disk">--/--GB</div>
                    </div>
                </div> 
                <div class="nas-metric-card">
                    <div class="nas-metric-icon"><i class="fas fa-history"></i></div>
                    <div class="nas-metric-details">
                        <span class="nas-metric-label">运行时间</span>
                        <div class="nas-metric-value small-font val-uptime">--</div>
                        <div class="nas-metric-subvalue sub-uptime">--</div>
                    </div>
                </div> 
            </div> 
            <div class="nas-status-footer"><span class="nas-status-text">正在连接...</span><span class="nas-error-text nas-error"></span></div> 
        </div>
    </template>

    <!-- 3. 通知条目模板 -->
    <template id="tpl-notification-item">
        <div class="notification-item">
            <span class="notification-content"></span>
            <span class="notification-timestamp"></span>
        </div>
    </template>

    <!-- 4. 天气卡片模板 -->
    <template id="tpl-weather-card">
        <div class="weather-card">
            <h2></h2> 
            <p class="weather-text"></p> 
            <p><strong>温度:</strong> <span class="val-temp"></span>°C (体感 <span class="val-feel"></span>°C)</p> 
            <p><strong>相对湿度:</strong> <span class="val-humid"></span>%</p> 
            <p class="timestamp"></p>
        </div>
    </template>

    <!-- 页面主体内容 -->

    <!-- 设置图标 (保留原功能) -->
    <div class="settings-icon" id="settings-icon"><i class="fas fa-cog"></i></div>
    <div class="settings-modal-overlay" id="settings-modal-overlay" style="display: none;">
        <!-- 设置模态框内容略，如果之前 JS 有处理 Modal 逻辑，可以在 nas.js 或 app.js 中补全 -->
        <div class="settings-modal">
             <div class="settings-modal-header"><h2>NAS 监控设置</h2><button class="close-button" onclick="document.getElementById('settings-modal-overlay').style.display='none'">&times;</button></div>
             <div class="settings-modal-content"><p>请在代码 config.js 中或本地存储中管理 URL。</p></div>
        </div>
    </div>

    <div class="container">
        <!-- 顶部信息栏 -->
        <div class="top-bar">
             <div class="time-info">
                <div class="time" id="current-time">00:00:00</div>
                <div class="date" id="current-date">--</div>
            </div>
            <div class="search-container">
                <form class="search-box" action="https://www.baidu.com/s" method="get" target="_blank">
                    <input type="text" name="wd" placeholder="百度一下..." required>
                    <button type="submit"><i class="fas fa-search"></i></button>
                </form>
            </div>
        </div>
        
        <div class="main-title"><p>Valar Morghulis</p></div>

        <!-- NAS 实时状态监控模块 -->
        <div id="nas-realtime-wrapper">
            <div id="nas-grid-container" class="nas-header-grid">
                <!-- JS 动态插入 -->
            </div>
        </div>
        
        <!-- 选项卡切换 -->
        <div class="tabs">
            <button class="tab-button active" data-tab="tab-links"><i class="fas fa-star"></i> 常用网站</button>
            <button class="tab-button" data-tab="tab-monitoring"><i class="fas fa-heartbeat"></i> 服务监控</button>
            <button class="tab-button" data-tab="tab-notifications"><i class="fas fa-bell"></i> 我的通知</button>
            <button class="tab-button" data-tab="tab-weather"><i class="fas fa-cloud-sun"></i> 天气仪表盘</button>
        </div>

        <!-- 选项卡内容区域 -->
        <div class="tab-content active" id="tab-links">
            <!-- JS 动态插入 -->
        </div>
        
        <div class="tab-content" id="tab-monitoring"></div>

        <div class="tab-content" id="tab-notifications">
            <div id="notifications-container">
                <header class="content-header">
                    <h1>我的通知和短信</h1>
                    <button class="btn" id="refresh-notifications-btn">刷新</button>
                </header>
                <div class="card">
                    <div id="notifications-list"></div>
                </div>
            </div>
        </div>

        <div class="tab-content" id="tab-weather">
            <div id="weather-dashboard-container">
                <div id="weather-loading-message">
                    <div class="loading-state"><div class="loading-spinner"></div><p>正在加载天气数据...</p></div>
                </div>
                <div id="latest-weather-cards" style="display: none;"></div>
                <div id="weather-charts-container" style="display: none;"></div>
            </div>
        </div>
        
        <footer>
            <p>© 2025 WanChuan | 让您的网络之旅更高效 | 已收录 <span id="site-count">0</span> 个优质网站</p>
        </footer>
    </div>
    
    <!-- 引入新的入口模块 -->
    <script type="module" src="js/app.js"></script>
    
    <!-- 保留现状的音乐播放器 -->
    <script type="text/javascript" src="https://myhkw.cn/player/js/jquery.min.js"></script>
    <script src="https://myhkw.cn/api/player/demo" id="myhk" key="demo" m="1" au="1"></script>
</body>
</html>
